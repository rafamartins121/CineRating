@model CineRating.Models.Filmes

@{
    ViewBag.Title = "Detalhes";
}

@*<h2>Details</h2>*@


    @if (Request.IsAuthenticated && User.IsInRole("Administradores")) {
        <p>
            @Html.ActionLink("Edit", "Edit", new { id = Model.ID }) |
            @Html.ActionLink("Delete", "Delete", new { id = Model.ID })
        </p>
    }
    <dl class="dl-horizontal">
        <dt>
            <span>Realizador</span>
        </dt>
        <dd>
            <p>@Model.Realizador.Nome</p>
            <a href="@Url.Action("Details", "Realizadores", new { id = Model.RealizadorFK })">
                <img src="~/imagens/realizadores/@Model.Realizador.Imagem" height="150" />
            </a>
        </dd>
        <dt>
            @Html.DisplayNameFor(model => model.Titulo)
        </dt>
        <dd>
            @Html.DisplayFor(model => model.Titulo)
        </dd>
        <dt>
            @Html.DisplayNameFor(model => model.Descricao)
        </dt>
        <dd>
            @Html.DisplayFor(model => model.Descricao)
        </dd>
        <dt>
            @Html.DisplayNameFor(model => model.TempoExecucao)
        </dt>
        <dd>
            @Html.DisplayFor(model => model.TempoExecucao) minutos
        </dd>
        <dt>
            @Html.DisplayNameFor(model => model.DataLancamento)
        </dt>
        <dd>
            @Html.DisplayFor(model => model.DataLancamento)
        </dd>
        <dt>
            <lbl>Géneros</lbl>
        </dt>
        <dd>
            @foreach (var gen in Model.ListaDeGeneros) {
                <p>
                    @Html.DisplayFor(modelItem => gen.Nome)
                </p>
            }
        </dd>
        <dt>
            @Html.DisplayNameFor(model => model.Imagem)
        </dt>
        <dd>
            <a href="~/imagens/filmes/@Model.Imagem" target="_blank">
                <img src="~/imagens/filmes/@Model.Imagem" height="150" />
            </a>
        </dd>
        <dt>
            @Html.DisplayNameFor(model => model.Video)
        </dt>
        <dd>
            <iframe src="@Model.Video"></iframe>
        </dd>
    </dl>
    <h2>Personagens</h2>
    @*style="display:flex; flex-direction:row; flex-wrap:wrap;*@
    <div class="row" style="display:flex; flex-direction:row; flex-wrap:wrap;">
        @foreach (var pers in Model.ListaDePersonagens) {
            <div style="text-align:center">
                <span>@pers.Role</span>
                @Html.Action("AtoresFilme", "Atores", new { filmeID = pers.AtorFK })
            </div>
        }
    </div>
    <h2>Comentários</h2>
    <div>
        @foreach (var coment in Model.ListaDeComentarios) {
            <div style="border-top:1px solid; margin-bottom:20px;">
                <span style="font-size:large; font-weight:bold">@coment.ID_User.Nome</span>
                <br />
                @Html.DisplayFor(model => coment.DataComentario)
                <br />
                @*@Html.TextAreaFor(model => coment.Texto, new { @readonly = "readonly", @disabled = "disabled", @style = "resize:none; width:100%; max-width:2000px; height:150px; font-size:medium" })*@
                <div style="margin: 10px 0 20px">
                    @coment.Texto
                </div>
                @if (Request.IsAuthenticated && (User.IsInRole("Administradores") || User.Identity.Name.Equals(coment.ID_User.NomeUtilizador))) {
                    <div style="text-align:right;">
                        <a href="@Url.Action("Delete", "Comentarios", new { id = coment.ID, filmeID = coment.FilmeFK })">Eliminar Comentário</a> 
                        @if (User.Identity.Name.Equals(coment.ID_User.NomeUtilizador)) {
                         <span>|</span>   <a href = "@Url.Action("Edit", "Comentarios", new { id = coment.ID, filmeID = coment.FilmeFK, userID = coment.UserFK })" > Editar Comentário </a>
                        }
                        <br/>
                        </div>
                    }
            </div>
        }
    </div>
    <div>
        @if (Request.IsAuthenticated) {
            <a href="@Url.Action("Create", "Comentarios", new { user = User.Identity.Name, filme = Model.ID })">Adicionar Comentario </a>
            @*@Html.Action("Create", "Comentarios", new { user = User.Identity.Name, filme = Model.ID })*@
        } else {
            <p style="font-weight:bold; color:red; font-size:x-large">Para poder comentar tem de fazer login!</p>
        }
    </div>



